<!doctype html>
<html>
  <head>
    <!-- Metadata about the presentation -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>gpt-invention</title>

    <meta name="description" content="投資？我都交給我的高級伴讀書僮- GPT！">
    <meta name="author" content="Ben Chen">

    <!-- Presentation Styles -->
    <link rel="stylesheet" href="static/revealjs/dist/reset.css">
    <link rel="stylesheet" href="static/revealjs/dist/reveal.css">

    
      <link rel="stylesheet" href="static/revealjs/dist/theme/black.css" id="theme">
    

    

    <!-- Theme used for syntax highlighted code -->
    <link rel="stylesheet" href="static/revealjs/plugin/highlight/monokai.css" id="highlight-theme">
  </head>

  <body>
    <!-- Presentation body -->
    <div class="reveal">

      <!-- Any section element inside of this container is displayed as a slide -->
      <div class="slides">
        
          
            
              <section data-markdown>
                <textarea data-template>
                  # 投資？我都交給我的高級伴讀書僮- GPT！




                </textarea>
              </section>
            
          
        
          
            
              <section data-markdown>
                <textarea data-template>
                  

## 用 27 個問題


                </textarea>
              </section>
            
          
        
          
            
              <section data-markdown>
                <textarea data-template>
                  

## 平均年化報酬 15%


                </textarea>
              </section>
            
          
        
          
            
              <section data-markdown>
                <textarea data-template>
                  

## 資金成長超過 10 倍


                </textarea>
              </section>
            
          
        
          
            <section>
              
                <section data-markdown>
                  <textarea data-template>
                    

> Investment must be rational; if you can't understand it, don't do it.
> 
> —— Warren Buffett, *Forbes 400, 21 October 1991*


                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

看財報來了解公司？


                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

財報動不動就幾十頁......看得有點累......



                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

這時候就要靠高級伴讀書僮- GPT！


                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

## 以下是我不會講的

- 原理
- 數學
- 明牌


                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

## 以下是我會講的

- 作法與流程
- 血汗與花費
- 地雷



                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

先來問問 ChatGPT 問題～


                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    


<!-- .slide: data-background="https://hackmd.io/_uploads/HyIpLLjrT.png" -->



                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

<!-- .slide: data-background="https://hackmd.io/_uploads/rJUTI8irT.png" -->



                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

這時候應該要用 RAG

## Retrival Augmented Generation


                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    



<!-- .slide: data-background-iframe="media/RAG.html" -->


                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

![](https://python.langchain.com/assets/images/data_connection-95ff2033a8faa5f3ba41376c0f6dd32a.jpg)

<font size=1>from: https://python.langchain.com/docs/modules/data_connection</font>


                  </textarea>
                </section>
              
            </section>
          
        
          
            
              <section data-markdown>
                <textarea data-template>
                  

<!-- .slide: data-background="#999999" -->

<!-- .slide: data-background-iframe="media/flow.html" -->


                </textarea>
              </section>
            
          
        
          
            <section>
              
                <section data-markdown>
                  <textarea data-template>
                    

## Data
- Annual Report --> Build 10-K Vector Database 
- Stock Price --> Training Model 



                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

### Annual Report (10-k filings)

- 原作：
    - [Financial Modeling Prep](https://site.financialmodelingprep.com/developer/docs/#Annual-Reports-on-Form-10-K)
    - 費用：29 美元/月
- 建議：
    - 使用爬蟲 [sec-edgar](https://github.com/sec-edgar/sec-edgar) 在 [SEC 美國證券交易委員會](https://www.sec.gov/edgar/searchedgar/companysearch) 抓取 10-k filings
    - 免費
    - 免費


                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

### Stock Price
- total 1505 stocks
    - S&P500, S&P400, S&P600
- 原作：
    - [`openbb`](https://openbb.co/)
- 建議：
    - [`yfinance`](https://finance.yahoo.com/)：Yahoo! Finance


                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

<!-- .slide: data-background="https://hackmd.io/_uploads/BktMtfN1a.png" -->



                  </textarea>
                </section>
              
            </section>
          
        
          
            <section>
              
                <section data-markdown>
                  <textarea data-template>
                    

## PreProcessing

- Sampling
- Build Vector Store
- 準備 27 關於財報的問題


                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

### Sample

- train: 1k datapoints (out of 17.4k)
- test: 500 datapoints (out of 6.8k) 



## Cost: 

- Money: $60
- Time: 50 hours



                  </textarea>
                </section>
              
            </section>
          
        
          
            
              <section data-markdown>
                <textarea data-template>
                  

## Embedding Model

- all-mpnet-base-v2
    - sentence-transformers model
    - maps sentences & paragraphs to a 768 dimensional dense vector space
    - used for tasks like clustering or semantic search
    - https://huggingface.co/sentence-transformers/all-mpnet-base-v2


```python!
embedding_model = LangchainEmbedding(
    HuggingFaceEmbeddings(model_name="sentence-transformers/all-mpnet-base-v2")
    ) 
```


                </textarea>
              </section>
            
          
        
          
            <section>
              
                <section data-markdown>
                  <textarea data-template>
                    

### Massive Text Embedding Benchmark
https://huggingface.co/blog/mteb
![](https://hackmd.io/_uploads/Bkq8xozJT.png)


                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

![](https://hackmd.io/_uploads/B1NrxsG16.png)


                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

### all-mpnet-base-v2
- Speed and performance balance
- Slightly slower
- significantly stronger


                  </textarea>
                </section>
              
            </section>
          
        
          
            
              <section data-markdown>
                <textarea data-template>
                  

## Vector DB

Chroma


                </textarea>
              </section>
            
          
        
          
            
              <section data-markdown>
                <textarea data-template>
                  

## Questions

27 questions

```json
{
    "management":"Does the company have a clear strategy for growth and innovation? Are there any recent strategic initiatives or partnerships?"
}


                </textarea>
              </section>
            
          
        
          
            
              <section data-markdown>
                <textarea data-template>
                  

```
1. feature_overall	
2. feature_revenue_1	
3. feature_revenue_2	
4. feature_revenue_3	
5. feature_profit_1	
6. feature_profit_2	
7. feature_debt_1	
8. feature_cashflow_2	
9. feature_dividend	
10. feature_management_1	
11. feature_management_2	
12. feature_industry_1	
13. feature_industry_2	
14. feature_research	
15. feature_guidance	
16. feature_leadership	
17. feature_macro	
18. feature_diversification	
19. feature_customerbase	
20. feature_esg	
21. feature_competition_1	
22. feature_competition_2	
23. feature_ip	
24. feature_digitaltransformation
25. feature_regulations	
26. feature_onlinepresence	
27. feature_legal



                </textarea>
              </section>
            
          
        
          
            
              <section data-markdown>
                <textarea data-template>
                  

## Model

- Linear Regression: enforces non-negativity in the coefficients


- X
    - Confidence Scores from GPT-3.5-Turbo
- Y: percentage return is calculated between two successive annual report filing dates
    - target_custom_22 
        - Annual Return
        - target created from 12 month normalised returns per year (aka era) and then binned
    - target_custom_2
        - 98th percentile of return from the filing date represented as target max
        - target created from max normalised returns in the span of 12 months per year (aka era) and then binned



                </textarea>
              </section>
            
          
        
          
            <section>
              
                <section data-markdown>
                  <textarea data-template>
                    

## Result


                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    


<!-- .slide: data-background="https://hackmd.io/_uploads/BksjiDtr6.png" -->


                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

<!-- .slide: data-background="https://hackmd.io/_uploads/HyC4hwYST.png" -->



                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    


<!-- .slide: data-background="https://hackmd.io/_uploads/B1CVnPKHp.png" -->


                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

<!-- .slide: data-background="https://hackmd.io/_uploads/HyCVnwFra.png" -->


                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    




<!-- .slide: data-background="https://hackmd.io/_uploads/rJCE2PFHa.png" -->


                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

<!-- .slide: data-background="https://hackmd.io/_uploads/rJ0VhvFB6.png" -->


                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

- 挑選股票
    - 每個月月底預測下個月最強的五檔股票
    - 若上個月所挑出來的股票比較強，則會被保留下來
    - 綜合上述做法，挑出五檔股票
- 月初開盤進場，月底收盤出場



                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

<!-- .slide: data-background-iframe="media/cumprod_amount_2018_2022.html" -->



                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

<!-- .slide: data-background-iframe="media/cumprod_amount_2002_2022.html" -->



                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

- 避開突發的損失
    - 下跌 10 % 就停止交易
    - 觀察下個月的情況，若可獲利，就進場下單



                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

<!-- .slide: data-background-iframe="media/cumprod_amount_2018_2022_trick.html" -->



                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    


<!-- .slide: data-background-iframe="media/cumprod_amount_2002_2022_trick.html" -->


                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

<!-- .slide: data-background-iframe="media/annual_return_2002_2022.html" -->



                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

## 年化報酬率：14%


                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

## 最大交易回落：28%


                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    

<!-- .slide: data-background-iframe="media/cumprod_amount_2023.html" -->


                  </textarea>
                </section>
              
            </section>
          
        
          
            <section>
              
                <section data-markdown>
                  <textarea data-template>
                    

分年分配目標值：
目的：為了在每年內相對排名股票的回報。
方法：每年單獨分配股票的目標值，這樣可以更好地比較同一年內不同股票的表現。

回報的排名和標準化：
首先：回報首先被排名，這意味著根據其回報率對股票進行排序。
然後：然後對排名後的回報進行標準化，這有助於消除數據中的任何潛在偏差或異常值。

目標值的範圍限制：
範圍：[0, 1]。
解釋：其中1表示更高的回報，這意味著目標值1表示該股票在該年度有更高的回報。

基於百分位數的分箱：
最後：對標準化的回報進行分箱，基於百分位數，這樣目標值的範圍是[0, 1]。
目的：這有助於創建一個更均勻和有序的目標值分布，可以更好地用於機器學習模型的訓練。


                  </textarea>
                </section>
              
                <section data-markdown>
                  <textarea data-template>
                    


                  </textarea>
                </section>
              
            </section>
          
        
      </div>

    </div>

    <!-- Reveal.js script -->
    <script src="static/revealjs/dist/reveal.js"></script>

    <!-- Reveal.js plugins -->
    <script src="static/revealjs/plugin/markdown/markdown.js"></script>
    <script src="static/revealjs/plugin/highlight/highlight.js"></script>
    <script src="static/revealjs/plugin/search/search.js"></script>
    <script src="static/revealjs/plugin/notes/notes.js"></script>
    <script src="static/revealjs/plugin/math/math.js"></script>
    <script src="static/revealjs/plugin/zoom/zoom.js"></script>

    <script>
      Reveal.initialize({
        math: {
          mathjax: 'static/mathjax/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          // pass other options into `MathJax.Hub.Config()`
          TeX: { Macros: { RR: "{\\bf R}" } }
        },
        plugins: [
          RevealMarkdown,
          RevealHighlight,
          RevealSearch,
          RevealNotes,
          RevealMath,
          RevealZoom
        ]
      });

      Reveal.configure({"autoAnimate": true, "autoAnimateDuration": 1.0, "autoAnimateEasing": "ease", "autoAnimateMatcher": null, "autoAnimateStyles": ["opacity", "color", "background-color", "padding", "font-size", "line-height", "letter-spacing", "border-width", "border-color", "border-radius", "outline", "outline-offset"], "autoAnimateUnmatched": true, "autoPlayMedia": null, "autoSlide": 0, "autoSlideMethod": null, "autoSlideStoppable": true, "backgroundTransition": "fade", "center": true, "controls": true, "controlsBackArrows": "faded", "controlsLayout": "bottom-right", "controlsTutorial": true, "defaultTiming": null, "disableLayout": false, "display": "block", "embedded": false, "focusBodyOnPageVisibilityChange": true, "fragmentInURL": true, "fragments": true, "hash": true, "hashOneBasedIndex": false, "help": true, "hideCursorTime": 5000, "hideInactiveCursor": true, "history": true, "keyboard": true, "keyboardCondition": null, "loop": false, "mobileViewDistance": 2, "mouseWheel": false, "navigationMode": "default", "overview": true, "pause": true, "pdfPageHeightOffset": -1, "pdfSeparateFragments": true, "postMessage": true, "postMessageEvents": false, "preloadIframes": null, "previewLinks": false, "progress": true, "respondToHashChanges": true, "rtl": false, "showNotes": false, "showSlideNumber": "all", "shuffle": false, "slideNumber": false, "touch": true, "transition": "slide", "transitionSpeed": "default", "viewDistance": 3});
    </script>
  </body>
</html>